<section class="profile-section my-5 py-4">
  <div class="container">
    <div class="row g-4">
      <!-- Sidebar -->
      <div class="col-lg-4">
        <div class="profile-sidebar" [@slideInLeft]>
          <!-- Profile Image Section -->
          <div class="profile-image-wrapper">
            <div class="imgBox mx-auto">
              <ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                @if (profilemeData?.image) {
                <div class="dz-thumb existing text-center">
                  <img
                    [src]="profilemeData.image"
                    [alt]="profilemeData.name"
                    class="profile-image"
                  />
                  <div class="image-overlay">
                    <i class="fa fa-camera"></i>
                    <span>Change Photo</span>
                  </div>
                </div>
                } @else { @if (files().length > 0) { @for (file of files(); track file) {
                <ngx-dropzone-image-preview
                  [file]="file"
                  [removable]="true"
                  (removed)="onRemove(file)"
                  class="dz-thumb"
                ></ngx-dropzone-image-preview>
                } } @else {
                <ngx-dropzone-label>
                  <div class="upload-placeholder">
                    <i class="fa fa-cloud-upload-alt"></i>
                    <span>Upload Your Image</span>
                  </div>
                </ngx-dropzone-label>
                } }
              </ngx-dropzone>
            </div>
          </div>

          <!-- User Info -->
          <div class="user-info text-center">
            <h4 class="user-name text-capitalize mb-1 fw-bold">
              {{ profilemeData?.name }}
            </h4>
            <p class="user-email mb-0">
              {{ profilemeData?.email }}
            </p>
          </div>

          <!-- Navigation Menu -->
          <nav class="profile-nav">
            <ul class="nav-menu list-unstyled" [@staggerMenu]>
              <li
                role="button"
                [class.active]="selectedTab === 'dashboard'"
                (click)="selectedTab = 'dashboard'"
              >
                <div class="menu-item-content">
                  <i class="fa fa-gauge menu-icon"></i>
                  <span class="menu-text">Dashboard</span>
                </div>
                <div class="menu-indicator"></div>
              </li>
              <li
                role="button"
                [class.active]="selectedTab === 'myProfile'"
                (click)="selectedTab = 'myProfile'"
              >
                <div class="menu-item-content">
                  <i class="fa fa-id-card menu-icon"></i>
                  <span class="menu-text">My Profile</span>
                </div>
                <div class="menu-indicator"></div>
              </li>
              <li
                role="button"
                [class.active]="selectedTab === 'myBooking'"
                (click)="selectedTab = 'myBooking'"
              >
                <div class="menu-item-content">
                  <i class="fa fa-clipboard-list menu-icon"></i>
                  <span class="menu-text">My Booking</span>
                </div>
                <div class="menu-indicator"></div>
              </li>
              <li
                role="button"
                [class.active]="selectedTab === 'myWishlist'"
                (click)="selectedTab = 'myWishlist'"
              >
                <div class="menu-item-content">
                  <i class="fa fa-heart-circle-plus menu-icon"></i>
                  <span class="menu-text">My Wishlist</span>
                </div>
                <div class="menu-indicator"></div>
              </li>
              <li
                role="button"
                [class.active]="selectedTab === 'setting'"
                (click)="selectedTab = 'setting'"
              >
                <div class="menu-item-content">
                  <i class="fa fa-gear menu-icon"></i>
                  <span class="menu-text">Settings</span>
                </div>
                <div class="menu-indicator"></div>
              </li>
              <li role="button" class="logout-item" (click)="logout()">
                <div class="menu-item-content">
                  <i class="fa fa-arrow-right-from-bracket menu-icon"></i>
                  <span class="menu-text">Logout</span>
                </div>
              </li>
            </ul>
          </nav>
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-lg-8">
        <div class="profile-content" [@slideInRight]>
          <!-- Dashboard Tab -->
          @if (selectedTab === 'dashboard') {
          <div class="tab-content" [@tabContent]>
            <div class="content-header mb-4">
              <h3 class="content-title">Dashboard Overview</h3>
              <p class="content-subtitle">Welcome back! Here's your activity summary</p>
            </div>
            <div class="row g-4" [@staggerCards]>
              <div class="col-md-6">
                <div class="stat-card booking-card">
                  <div class="stat-icon-wrapper booking-icon">
                    <i class="fa fa-shopping-cart"></i>
                  </div>
                  <div class="stat-content">
                    <h2 class="stat-number">{{ tourCart.length }}</h2>
                    <p class="stat-label">Total Bookings</p>
                  </div>
                  <div class="stat-decoration"></div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="stat-card favorite-card">
                  <div class="stat-icon-wrapper favorite-icon">
                    <i class="fa fa-heart-circle-plus"></i>
                  </div>
                  <div class="stat-content">
                    <h2 class="stat-number">{{ favList.length }}</h2>
                    <p class="stat-label">Favorite Tours</p>
                  </div>
                  <div class="stat-decoration"></div>
                </div>
              </div>
            </div>
          </div>
          }

          <!-- My Profile Tab -->
          @if (selectedTab === 'myProfile') {
          <div class="tab-content" [@tabContent]>
            <div class="content-header mb-4">
              <h3 class="content-title">Profile Information</h3>
              <p class="content-subtitle">Your personal details and account information</p>
            </div>
            <div class="profile-info-card">
              <div class="info-item">
                <div class="info-icon">
                  <i class="fa fa-user"></i>
                </div>
                <div class="info-content">
                  <span class="info-label">Full Name</span>
                  <span class="info-value">{{ profilemeData?.name || 'Antoni Jonson' }}</span>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">
                  <i class="fa fa-envelope"></i>
                </div>
                <div class="info-content">
                  <span class="info-label">Email</span>
                  <span class="info-value">{{ profilemeData?.email || 'jonsonexample.com' }}</span>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">
                  <i class="fa fa-phone"></i>
                </div>
                <div class="info-content">
                  <span class="info-label">Phone</span>
                  <span class="info-value">{{ profilemeData?.phone || '+2 134 562 458' }}</span>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">
                  <i class="fa fa-map-marker-alt"></i>
                </div>
                <div class="info-content">
                  <span class="info-label">Address</span>
                  <span class="info-value">{{ profilemeData?.address || 'New York, USA' }}</span>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">
                  <i class="fa fa-calendar-alt"></i>
                </div>
                <div class="info-content">
                  <span class="info-label">Join Date</span>
                  <span class="info-value">{{
                    profilemeData?.created_at
                      ? (profilemeData.created_at | date)
                      : '21 August, 2025'
                  }}</span>
                </div>
              </div>
            </div>
          </div>
          }

          <!-- My Booking Tab -->
          @if (selectedTab === 'myBooking') {
          <div class="tab-content" [@tabContent]>
            <div class="content-header mb-4">
              <h3 class="content-title">My Bookings</h3>
              <p class="content-subtitle">Manage and view your tour bookings</p>
            </div>
            @if (haveData) {
            <owl-carousel-o [options]="bookingOptions">
              @for (cart of tourCart; track $index) { @if (cart.tour) {
              <ng-template carouselSlide>
                <div class="booking-item">
                  <app-tour-cart [tour]="cart.tour"></app-tour-cart>
                  <div class="booking-details">
                    <div class="detail-row">
                      <span class="detail-label">Guests:</span>
                      <span class="detail-value">
                        <span *ngIf="cart.adults" class="badge">{{ cart.adults }} Adults</span>
                        <span *ngIf="cart.children" class="badge"
                          >{{ cart.children }} Children</span
                        >
                        <span *ngIf="cart.infants" class="badge">{{ cart.infants }} Infants</span>
                      </span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Total Price:</span>
                      <span class="detail-value price">{{ cart.totalPrice | currency }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Booking Date:</span>
                      <span class="detail-value">{{ cart.start_date | date }}</span>
                    </div>
                  </div>
                </div>
              </ng-template>
              } }
            </owl-carousel-o>
            } @else {
            <div class="empty-state">
              <i class="fa fa-shopping-cart empty-icon"></i>
              <h4>No Tours in Booking Cart</h4>
              <p>Start exploring and book your first tour!</p>
            </div>
            }
          </div>
          }

          <!-- My Wishlist Tab -->
          @if (selectedTab === 'myWishlist') {
          <div class="tab-content" [@tabContent]>
            <div class="content-header mb-4">
              <h3 class="content-title">My Wishlist</h3>
              <p class="content-subtitle">Your saved favorite tours</p>
            </div>
            @if (haveData) {
            <owl-carousel-o [options]="bookingOptions">
              @for (cart of favList; track $index) {
              <ng-template carouselSlide>
                <app-tour-cart [tour]="cart"></app-tour-cart>
              </ng-template>
              }
            </owl-carousel-o>
            } @else {
            <div class="empty-state">
              <i class="fa fa-heart empty-icon"></i>
              <h4>No Tours in Wishlist</h4>
              <p>Add tours to your wishlist to save them for later!</p>
            </div>
            }
          </div>
          }

          <!-- Settings Tab -->
          @if (selectedTab === 'setting') {
          <div class="tab-content" [@tabContent]>
            <div class="content-header mb-4">
              <h3 class="content-title">Account Settings</h3>
              <p class="content-subtitle">Update your profile information and preferences</p>
            </div>
            <form
              [formGroup]="updateProfile"
              (ngSubmit)="submitProfileData()"
              class="settings-form"
            >
              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="name" class="form-label">
                      <i class="fa fa-file-signature"></i>
                      Full Name
                    </label>
                    <input
                      type="text"
                      id="name"
                      formControlName="name"
                      placeholder="Your Full Name"
                      class="form-control modern-input"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="phone" class="form-label">
                      <i class="fa fa-phone-volume"></i>
                      Phone
                    </label>
                    <input
                      type="tel"
                      id="phone"
                      formControlName="phone"
                      placeholder="Your Phone"
                      class="form-control modern-input"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="password" class="form-label">
                      <i class="fa fa-lock"></i>
                      Password
                    </label>
                    <input
                      type="password"
                      id="password"
                      formControlName="password"
                      placeholder="Your Password"
                      class="form-control modern-input"
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="password_confirmation" class="form-label">
                      <i class="fa fa-lock"></i>
                      Confirm Password
                    </label>
                    <input
                      type="password"
                      id="password_confirmation"
                      formControlName="password_confirmation"
                      placeholder="Confirm Your Password"
                      class="form-control modern-input"
                    />
                  </div>
                </div>
                <div class="col-12">
                  <div class="form-group">
                    <label for="nationality" class="form-label">
                      <i class="fa fa-globe"></i>
                      Nationality
                    </label>
                    <select
                      id="nationality"
                      formControlName="nationality"
                      class="form-control modern-input"
                    >
                      <option selected disabled>Select Your Nationality</option>
                      @for (item of countriesList; track $index) {
                      <option [value]="item.name">{{ item.name }}</option>
                      }
                    </select>
                  </div>
                </div>
                <div class="col-12">
                  <button type="submit" class="btn-update">
                    <i class="fa fa-save me-2"></i>
                    Update Profile Info
                  </button>
                </div>
              </div>
            </form>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</section>
